<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ê¸°ì„¸ ë¹„êµ</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© ë§í¬ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
<style>
	html, body {
	  height: 100%;
	  margin: 0;
	  display: flex;
	  flex-direction: column;
	}
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
    }
    /* í—¤ë” ì‹œì‘ */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 30px;
      background-color: #f8f8f8;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .logo-site {
      display: flex;
      align-items: center;
    }
    /* ë‚´ë¹„ ë¡œê³  */
    #header_logo {
      width: 40px;
    }

    .site-name {
      font-size: 1.7rem;
      font-weight: bold;
    }

    nav {
      margin-left: 10px; /* ì‚¬ì´íŠ¸ëª…ê³¼ ë©”ë‰´ ì‚¬ì´ ê°„ê²© */
    }

    .menu {
      display: flex;
      gap: 60px;
      margin-right: 120px;
    }
    /* ë‚´ë¹„ ë©”ë‰´ ë§í¬ */
    .menu a {
      text-decoration: none;
      color: #333;
      font-size: 1.3rem;
      transition: color 0.3s;
      font-weight: bold;
    }
    /* ë‚´ë¹„ ë©”ë‰´ ì»¤ì„œ íš¨ê³¼ */
    .menu a:hover {
      color: #2B8122;
    }

    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }

      nav {
        margin-left: 0;
        margin-top: 10px;
      }

      .menu {
        flex-direction: column;
        gap: 10px;
      }
    }

    /* main ì‹œì‘*/
    main {
		flex: 1;
        margin-left: 50px;
        margin-right: 50px;
    }
    .title{
        margin-top: 40px; /* í—¤ë”ì™€ì˜ ê°„ê²© ì¶”ê°€ */
        margin-left: 100px;
        margin-right: 100px;
    }
    .main-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .page-title {
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0;
    }

    /* ì•„ì´ì½˜ ì¶”ê°€ ì‹œ í¬ê¸° ì¡°ì ˆì´ë‚˜ ì—¬ë°± ì¡°ì ˆ ê°€ëŠ¥ */
    .icon-area img {
        cursor: pointer;
        transition: color 0.3s;
        width: 120px;
    }
    /* íƒ€ì´í‹€ ì œëª© ê¸€ì”¨ ìƒ‰ ë³€ê²½ */
    .highlight {
    color: #DAB500;
    }
    /* ìš°ë¦¬ ì§‘, ë‹¤ë¥¸ ì§‘ ì¡°íšŒ  */
    .comparison-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 40px;
    margin-top: 40px;
    flex-wrap: wrap;
  }

  .box-wrapper {
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    padding: 20px 30px 30px 30px;
    width: 320px;
  }

  .box-title-home,
  .box-title-other {
    font-weight: bold;
    font-size: 1.2rem;
    text-align: center;
    margin-bottom: 8px;
    padding: 6px 160px;
    border-radius: 8px;
    display: inline-block;
  }

  .box-title-home {
    background-color: #FBE5A2;
  }
  .box-title-other {
    background-color: #A7EDE3;
  }

  .input-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .input-group label {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .input-group select,
  .input-group input {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 1rem;
  }

  .search-btn {
    margin-top: 20px;
    width: 100%;
    padding: 10px;
    font-size: 1.1rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  .home-box {
    /* background-color: #FFF3C4; */
    background-color: white;
    border-color: #FFD966;
    width: 100%;
  }

  .home-box .search-btn {
    background-color: #F5D776;
  }

  .other-box {
    background-color: white;
    border-color: #A7EDE3;
    padding-bottom: 30px;
    width: 100%;
  }

  .other-box .search-btn {
    background-color: #8be2d5;
    margin-top: 80px;
  }

  /* í…Œì´ë¸” */
  .table-wrapper {
    margin-top: 20px;
    width: 100%;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
    font-size: 0.95rem;
  }

  .home-table thead {
    background-color: #FBE5A2;
    font-weight: bold;
  }

  .other-table thead {
    background-color: #c7f0ee;
    font-weight: bold;
  }

  .home-table td,
  .home-table th {
    border: 1px solid #f2c94c;
    padding: 8px;
  }

  .other-table td,
  .other-table th {
    border: 1px solid #6dd5c5;
    padding: 8px;
  }

  /* ë¹„êµ ë²„íŠ¼ */
  .compare-button {
    background-color: #A8E3A2;
    color: black;
    font-weight: bold;
    padding: 12px 32px;
    font-size: 1.2rem;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    width: 350px;
    margin-bottom: 100px;
    margin-top: 40px;
  }

    /* ===== í˜ì´ì§• ë²„íŠ¼ ===== */
    .pagination-container {
    display: flex;
    justify-content: center;
    margin-top: 15px;
    gap: 8px;
    }

    .pagination-btn {
    background-color: #eee;
    border: 1px solid #ccc;
    padding: 8px 14px;
    border-radius: 6px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background-color 0.3s;
    }

    .pagination-btn:hover {
    background-color: #ccc;
    }

    #home-pagination .pagination-btn.active {
    background-color: #FBE5A2;  /* ìš°ë¦¬ì§‘ í•˜ì´ë¼ì´íŠ¸ ìƒ‰ */
    border-color: #f2c94c;
    font-weight: bold;
    }

    #other-pagination .pagination-btn.active {
    background-color: #A7EDE3;  /* ë‹¤ë¥¸ì§‘ í•˜ì´ë¼ì´íŠ¸ ìƒ‰ */
    border-color: #6dd5c5;
    font-weight: bold;
    }
    
    .mySelected {
	  background-color: #fff4c2; /* ë…¸ë‘ */
	  font-weight: bold;
	}

	.otherSelected {
	  background-color: #d6f5e8;
	  font-weight: bold;
	}
	/* ===== í‘¸í„° ===== */
	footer {
	    text-align: center;
	    padding: 8px 0;
	    font-size: 0.85rem;
	    color: #666;
	    background-color: #f8f8f8;
	    width: 100%;
	    margin-top: auto;
	    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.8);
	}
	footer p:first-of-type {
	  margin-top: 6px;  
	}	
</style>
<body>
    <!-- í—¤ë” ì‹œì‘ -->
<header>
    <div class="logo-site">
      <!-- ë‚´ë¹„ ë¡œê³  -->
	  <a href="/" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
	     <div class="logo"><img src="./icon/ë©”ì¸ë¡œê³ _ë°°ê²½íˆ¬ëª…í™”.png" id="header_logo"></div>
	     <!-- ë‚´ë¹„ ì‚¬ì´íŠ¸(í”„ë¡œì íŠ¸) ì´ë¦„ -->
	     <div class="site-name">A.P.T</div>
	  </a>
    </div>
    <nav>
      <!-- ë‚´ë¹„ ë©”ë‰´ -->
      <div class="menu">
	      <a href="calculation">ëŒ€ê¸°ì „ë ¥ ê³„ì‚°</a>
	      <a href="/dashboard">ì „ë ¥ ì‚¬ìš©ëŸ‰ í†µê³„</a>
	      <a href="/feeCompare">ì „ë ¥ ì‚¬ìš©ëŸ‰ ë¹„êµ</a>
	      <a href="/product">ê°€ì „ ì œí’ˆ ì¶”ì²œ</a>
      </div>
    </nav>
  </header>
  <!-- í—¤ë” ë -->
   <main>
    <!-- í˜ì´ì§€ ì œëª©+ì•„ì´ì½˜ ì‹œì‘ -->
    <section class="title">
        <div class="main-header">
            <h1 class="page-title">
                ìš°ë¦¬ ì§‘ê³¼ ë‹¤ë¥¸ ì§‘<br><span class="highlight">ì „ê¸°ì„¸</span>
                ì°¨ì´ëŠ”?
              </h1>
            <div class="icon-area">
              <!-- ì•„ì´ì½˜ ì˜ˆì‹œ: Font Awesome ì•„ì´ì½˜ ë˜ëŠ” SVG ë“± ì‚¬ìš© ê°€ëŠ¥ -->
              <img class="fa-solid fa-gear" src="./icon/ì „ê¸°ë£Œë¹„êµ_ë¹„êµ.png">
            </div>
          </div>
    </section>
    <!-- í˜ì´ì§€ ì œëª©+ì•„ì´ì½˜ ë -->
    <!-- ìš°ë¦¬ ì§‘, ë‹¤ë¥¸ ì§‘ ì¡°íšŒ -->
    <section class="comparison-container">
        <!-- ìš°ë¦¬ ì§‘ -->
      <div style="display: flex; flex-direction: column; align-items: center;">
        <div class="box-title-home">ìš°ë¦¬ ì§‘</div>
        <div class="box-wrapper home-box">
          <div class="input-group">
            <div>
              <label for="year-home">ì¡°íšŒë‚ ì§œ</label>
              <select id="year-home" style="width: 95px;">
                <option th:each="year : ${yearList}" th:value="${year}" th:text="${year}"></option>
              </select>
              <select id="date-home" style="width: 100px;">
                <option th:each="month : ${monthList}" th:value="${month}" th:text="${month}"></option>
              </select>
            </div>
            <div>
              <label>ì§€ì—­ê²€ìƒ‰</label>
              <!-- <div style="display: flex; gap: 10px;"> -->
                <select style="width: 95px;" class="districtSelect">
                  <option>ìì¹˜êµ¬</option>
                  <option th:each="dist : ${districtList}" th:value="${dist}" th:text="${dist}"></option>
                </select>
                <select style="width: 100px;" class="dongSelect" id="myDongSelect">
                  <option>ë™</option>
                </select>
              <!-- </div>  -->
            </div>
            <div>
              <label for="address-search">ì£¼ì†Œ ê²€ìƒ‰</label>
              <input type="text" id="address-search" placeholder="ì£¼ì†Œ ì…ë ¥">
            </div>
          </div>
          <button class="search-btn" id="mySearchBtn">ì¡°íšŒ</button>
        </div>
        <!-- í‘œ -->
      <div class="table-wrapper table-home" style="display: none;">
        <table class="home-table">
          <thead>
            <tr>
              <th>ì•„íŒŒíŠ¸ì´ë¦„</th>
              <th>ì£¼ì†Œ</th>
            </tr>
          </thead>
          <tbody id="myAptResultBody">
            <!-- scriptë¡œ ì¶”ê°€ë¨ -->
          </tbody>
        </table>
      </div>
      </div>
        <!-- ë‹¤ë¥¸ ì§‘ -->
      <div style="display: flex; flex-direction: column; align-items: center;">
        <div class="box-title-other">ë‹¤ë¥¸ ì§‘</div>
        <div class="box-wrapper other-box">
          <div class="input-group">
            <div>
              <label for="year-other">ì¡°íšŒë‚ ì§œ</label>
              <select id="year-other" style="width: 95px;">
                <option th:each="year : ${yearList}" th:value="${year}" th:text="${year}"></option>
              </select>
              <select id="date-other" style="width: 100px;">
                <option th:each="month : ${monthList}" th:value="${month}" th:text="${month}"></option>
              </select>
            </div>
            <div>
              <label>ì§€ì—­ê²€ìƒ‰</label>
              <!-- <div style="display: flex; gap: 10px;"> -->
                <select style="width: 95px;" class="districtSelect">
                  <option>ìì¹˜êµ¬</option>
                  <option th:each="dist : ${districtList}" th:value="${dist}" th:text="${dist}"></option>
                </select>
                <select style="width: 100px;" class="dongSelect" id="otherDongSelect">
                  <option>ë™</option>
                </select>
              <!-- </div> -->
            </div>
          </div>
          <button class="search-btn" onclick="showTable('other')" id="otherDongBtn">ì¡°íšŒ</button>
        </div>
         <!-- í‘œ -->
        <div class="table-wrapper table-other" style="display: none;">
          <table class="other-table">
            <thead>
              <tr>
                <th>ì•„íŒŒíŠ¸ì´ë¦„</th>
                <th>ì£¼ì†Œ</th>
              </tr>
            </thead>
            <tbody id="otherAptResultBody">
				<!-- scriptë¡œ ì¶”ê°€ë  ë¶€ë¶„ -->
            </tbody>
          </table>
        </div>
	</div><!-- ì•ˆ ë‹«í˜€ìˆì–´ì„œ ìˆ˜ì •í•¨ -->
      </section>
      <!-- ë¹„êµ ë²„íŠ¼ -->
    <div style="text-align: center; margin-top: 20px;">
		<form style="text-align: center; margin-top: 20px;">
			<input type="hidden" name="myKaptCode" id="myKaptCode">
			<input type="hidden" name="otherKaptCode" id="otherKaptCode">
			<button class="compare-button" onclick="openComparisonPopup()">ë¹„êµ</button>
		</form>
    </div>
    <!-- ë¹„êµ ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="comparison-result" style="display: none; margin-top: 30px; text-align: center;">
      <div class="box-title-home" style="margin-right: 20px;">ìš°ë¦¬ ì§‘</div>
      <div class="box-title-other" style="margin-left: 20px;">ë‹¤ë¥¸ ì§‘</div>
        </div>
    <!-- </div> -->
   </main>
   <!-- í‘¸í„° -->
    <footer>
        <p>Â© 2025 A.P.T All rights reserved.</p>
        <p>Made with ğŸ–¥ï¸ by E.F</p>
    </footer>
<script>
  function showTable(type) {
    if (type === 'home') {
      document.querySelector('.table-home').style.display = 'block';
    } else if (type === 'other') {
      document.querySelector('.table-other').style.display = 'block';
    }
  }
</script>

<!-- ë™ ì¶œë ¥ -->
<script>
	$('.districtSelect').on('change', function () {
	  const district = $(this).val();
	  const $dongSelect = $(this).closest('.input-group').find('.dongSelect');
	
	  $.ajax({
	    url: '/dongList',
	    type: 'GET',
	    data: { district },
	    success: function (dongList) {
	    	$dongSelect.empty();
	      dongList.forEach(dong => {
	        $dongSelect.append(`<option value="${dong}">${dong}</option>`);
	      });
	    }
	  });
	});
</script>

<!-- ìš°ë¦¬ì§‘ ê²€ìƒ‰ -->
<script>
	// ìš°ë¦¬ì§‘ ì•„íŒŒíŠ¸ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ í•¨ìˆ˜
	function loadMyAptList(dong, addressNum) {
	  fetch(`/getMyAptList?dong=${dong}&addressNum=${addressNum}`)
	    .then(response => response.json())
	    .then(data => {
	      const tbody = document.getElementById("myAptResultBody");
	      tbody.innerHTML = "";
	
	      data.forEach(apt => {
	        const row = document.createElement("tr");
	        row.setAttribute("data-code", apt.kaptCode);
	        row.style.cursor = "pointer";
	
	        row.addEventListener("click", function () {
	          document.getElementById("myKaptCode").value = this.getAttribute("data-code");
			  // kaptCode í™•ì¸
			  console.log("ìš°ë¦¬ì§‘: ", document.getElementById("myKaptCode").value)
	          
	          document.querySelectorAll(".home-table tbody tr").forEach(r => r.classList.remove("mySelected"));
	          this.classList.add("mySelected");
	        });
	
	        row.innerHTML = `
	          <td>${apt.kaptName}</td>
	          <td>${apt.address}</td>
	        `;
	
	        tbody.appendChild(row);
	      });
	    });
	}
	
	// ì¡°íšŒ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
	document.getElementById("mySearchBtn").addEventListener("click", function () {
	  const dong = document.getElementById("myDongSelect").value;
	  const addressNum = document.getElementById("address-search").value;
	
	  if (!dong || dong === "ë™" || !addressNum) {
	    alert("ë™ê³¼ ë²ˆì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”!");
	    return;
	  }
	
	  showTable("home"); // í…Œì´ë¸” í‘œì‹œ
	  loadMyAptList(dong, addressNum); // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
	});
</script>

<!-- ë‹¤ë¥¸ì§‘ ê²€ìƒ‰ -->
<script>
	document.getElementById("otherDongBtn").addEventListener("click", function () {
		const dong = document.getElementById("otherDongSelect").value;
	
		  if (!dong || dong === "ë™") {
			    alert("ë™ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
			    return;
			  }
		  
		  
		  fetch(`/getOtherAptList?dong=${dong}`)
		    .then(response => response.json())
		    .then(data => {
		      const tbody = document.getElementById("otherAptResultBody");
		      tbody.innerHTML = ""; // ê¸°ì¡´ í–‰ ì œê±°
	
		      data.forEach(apt => {
		        const row = document.createElement("tr");
		        row.setAttribute("data-code", apt.kaptCode);
		        row.style.cursor = "pointer";
	
		        row.addEventListener("click", function () {
		          // kaptCode ì €ì¥
		          document.getElementById("otherKaptCode").value = this.getAttribute("data-code");
				  // kaptCode ì €ì¥ í™•ì¸
				  console.log("ë‹¤ë¥¸ì§‘: ", document.getElementById("otherKaptCode").value)
		          
		          // ì„ íƒ íš¨ê³¼
		          document.querySelectorAll(".other-table tbody tr").forEach(r => r.classList.remove("otherSelected"));
		          this.classList.add("otherSelected");
		          
		          document.querySelectorAll(".home-table tbody tr").forEach(r => r.classList.remove("otherSelected"));
		        });
	
		        row.innerHTML = `
		          <td>${apt.kaptName}</td>
		          <td>${apt.address}</td>
		        `;
	
		        tbody.appendChild(row);
		      });
		    });
		});
</script>

<!-- ë¹„êµ ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… -->
<script>
function openComparisonPopup() {
	const width = window.innerWidth * 0.6;  // í˜„ì¬ ë¸Œë¼ìš°ì € ë„ˆë¹„ì˜ 70%
    const height = window.innerHeight * 0.9; // í˜„ì¬ ë¸Œë¼ìš°ì € ë†’ì´ì˜ 90%
    const left = (window.innerWidth - width) / 2;
    const top = (window.innerHeight - height) / 2;
    
    // ê·¸ë˜í”„ì™€ í‘œë¥¼ ê·¸ë¦¬ê¸° ìœ„í•œ ë°ì´í„° ë„˜ê¸°ê¸°
    const myKaptCode = document.getElementById("myKaptCode").value; // ìš°ë¦¬ì§‘ ì•„íŒŒíŠ¸ ì½”ë“œ
    const otherKaptCode = document.getElementById("otherKaptCode").value; // ë‹¤ë¥¸ì§‘ ì•„íŒŒíŠ¸ ì½”ë“œ
    const myYear = document.getElementById("year-home").value; // ìš°ë¦¬ì§‘ ë°œìƒë…„
    const myMonth = document.getElementById("date-home").value; // ìš°ë¦¬ì§‘ ë°œìƒì›”
    const otherYear = document.getElementById("year-other").value; // ë‹¤ë¥¸ì§‘ ë°œìƒë…„
    const otherMonth = document.getElementById("date-other").value; // ë‹¤ë¥¸ì§‘ ë°œìƒì›”

 	// ìœ íš¨ì„± ì²´í¬ (ì„ íƒ ì•ˆ í–ˆì„ ë•Œ)
    if (!myKaptCode || !otherKaptCode) {
      alert("ìš°ë¦¬ì§‘ê³¼ ë‹¤ë¥¸ì§‘ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”!");
      return;
    }
    
 	// URL íŒŒë¼ë¯¸í„°ë¡œ ê°’ì„ ë„˜ê²¨ì„œ íŒì—… ì°½ì„ ì—´ê¸°
    const url = `feeComparePopup?myKaptCode=${myKaptCode}&otherKaptCode=${otherKaptCode}&myYear=${myYear}&myMonth=${myMonth}&otherYear=${otherYear}&otherMonth=${otherMonth}`;
    
    window.open(
        url,
        '_blank',
        `width=${width},height=${height},left=${left},top=${top},scrollbars=yes,resizable=yes`
    	);
	}
</script>
</body>
</html>